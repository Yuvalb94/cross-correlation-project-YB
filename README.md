# Overview
This repository is a summary of my cross-correlation project as a part of my bachelors degree in Neuroscience. 
This was my first coding project, so the scripts are basic and they could appear slightly disorganized. I kept them as they were so i can go back and see my progress and what iv'e learned.

# The project
The project, a part of my bachelors degree in Neuroscience, aimed to asses how the neural connectivity within a population of neurons in a rat's gustatory cortex of the brain changes as the rat goes through a proccess of conditional taste aversion. The project was under the guidance of Dr. Anan Moran and in collaboration with his lab in Tel Aviv University. The data was recorded and sorted by lab members and given to me in the form of spike trains (a neuron's recorded activity, also reffered to as spikes, over time). Within the time that i could invest in this project, i was able to reach the point where the mechanism for assesing the connectivity within a population of neurons is working, and further work can use that mechanism to calculate changes in connectivity over the period of the taste aversion paradigm, and ask questions about the results.

throughout my work, I analyzed that data in order to find the connectivity within this group of neurons. Connectivity is derived from synchronized activity between a pair of neurons, so that the neurons 'fire' within a certain time proximity. For example, if in many occasions, whenever neuron A fires, Neuron B fires within 5 milliseconds, we can assume that neuron A drives the activity of neuron B and thus they are connected. To assert this kind of connection, I calculated the cross-correlation between every pair of neuron's activity (spike trains), and plotted that in a PSTH-like histogram that shows the mean activity of neuron B relative to that of neuron A. Then I applied a statistical method called Generalized Linear Model onto that histogram to calulate whether this activity pattern excludes from what would be expected if the neurons were not connected. Significant exclusions are considered to be connections. 
In the final part of my work, I managed to show the neuronal connectivity in an elaborate and informative plot. 

# The scripts
The repository includes the scripts that I used in every step of the way:
1. [plot_PSTH](https://github.com/Yuvalb94/cross-correlation-project-YB/blob/45601052a3a2eef9595f83c6959fb30782c70c9b/plot_PSTH.py) - This script was generated in the first step, where I enountered the term PSTH - Post Stimulation Time Histogram. This is a histogram that shows the scope of neuronal activity before, during, and after a given stimulation (marked as the 0 in the histogram). This method allows us to asses what was the effect that the stimulation (for example - an administration of a flavor into the rat's mouth) had on the activity of the neuron. This script takes the spike train on a single neuron, and point in time when an event occured and plots a histogram that shows the activity of that neuron within a certain amount of time (for example 50 millisedconds) before and after the event.
2.  [cross_correlation]([
](https://github.com/Yuvalb94/cross-correlation-project-YB/blob/45601052a3a2eef9595f83c6959fb30782c70c9b/cross_correlation.py)) - I generated this script in the second step in which I learned the process of cross-correlation. I then tried to calculate it from scratch based on given data of real neural activity (spike trains), and implement the first script of producing PSTH's to show the correlation between the two neurons' activity and proximity in time(see [example](https://github.com/Yuvalb94/cross-correlation-project-YB/blob/45601052a3a2eef9595f83c6959fb30782c70c9b/Figures/Cross_Correlation_Histogram_example.png)). Then, I applied a statistical analysis based on a Generalized Linear Model onto those histograms. The green smoothed line that you can see in the example above, shows the average, or expectd value, given the activity of these two neurons if they do not have an effect on each other (considered to be a neural connection). The magenta and cyan lines represent significant deviations from this 'expected' value, calculated only within a few milliseconds range from every recorded spike of one neuron to the activity of the other. These deviations, if significant, are considered to imply that there is a connection between the neurons, a connection that will later be represente in the final product - the connectivity matrix.
3. [connectivity_matrix](https://github.com/Yuvalb94/cross-correlation-project-YB/blob/45601052a3a2eef9595f83c6959fb30782c70c9b/process_and_plot_W_2d.py). This script is the major script, the one i spent most of the time on. Its purpose is to take the cross-correlation calculations, together with the statistical analysis, to determine the connectivity between all possible pairs of neurons within the neuron population that we had data for (132 neurons). Then, present it in a informative way ([example](https://github.com/Yuvalb94/cross-correlation-project-YB/blob/45601052a3a2eef9595f83c6959fb30782c70c9b/Figures/connectivity_matrix_example.png)). The matrix show the connectivity in this neuron population, as neurons are aligned in the rows and the columns so that the intersection between each pair of neuron shows the if they are connected and to what extent. The magenta and cyan squares represent existing connections. 
